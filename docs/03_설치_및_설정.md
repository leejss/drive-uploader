# 설치 및 설정

## 시스템 요구사항

- **Go**: 1.24.0 이상
- **운영체제**: Windows, macOS, Linux
- **인터넷 연결**: Google Drive API 접근을 위한 네트워크 연결

## 설치 방법

### 1. 소스 코드에서 빌드

```bash
# 리포지토리 클론
git clone https://github.com/leejss/drive-uploader.git
cd drive-uploader

# 의존성 다운로드
go mod download

# 바이너리 빌드
go build -o drive-uploader ./cmd/drive-uploader

# 빌드된 바이너리 실행
./drive-uploader -file <파일경로>
```

### 2. 직접 실행 (개발 환경)

```bash
# 리포지토리 클론
git clone https://github.com/leejss/drive-uploader.git
cd drive-uploader

# 의존성 다운로드
go mod download

# 직접 실행
go run ./cmd/drive-uploader -file <파일경로>
```

## Google Cloud 설정

### 1. Google Cloud 프로젝트 생성

1. [Google Cloud Console](https://console.cloud.google.com/)에 접속
2. 새 프로젝트 생성 또는 기존 프로젝트 선택
3. 프로젝트 이름 기억 (나중에 필요)

### 2. Google Drive API 활성화

1. Google Cloud Console에서 **API 및 서비스** > **라이브러리**로 이동
2. "Google Drive API" 검색
3. **활성화** 클릭

### 3. OAuth 2.0 동의 화면 구성

1. **API 및 서비스** > **OAuth 동의 화면**으로 이동
2. **User Type** 선택:
   - **외부**: 모든 Google 사용자 대상 (추천)
   - **내부**: Google Workspace 조직 내부 사용자만
3. **만들기** 클릭
4. 앱 이름, 사용자 지원 이메일, 개발자 연락처 정보 입력
5. **범위** 단계에서 **범위 추가 또는 삭제** 클릭
6. `https://www.googleapis.com/auth/drive.file` 추가
7. **테스트 사용자** 단계에서 테스트할 Google 계정 추가
8. **앱으로 돌아가기** 클릭

### 4. OAuth 2.0 자격 증명 생성

1. **API 및 서비스** > **사용자 인증 정보**로 이동
2. **+ 사용자 인증 정보 만들기** > **OAuth 2.0 클라이언트 ID** 선택
3. **애플리케이션 유형**으로 **데스크톱 앱** 선택
4. 이름 입력 (예: "Drive Uploader Desktop")
5. **만들기** 클릭
6. **JSON 다운로드** 클릭하여 `credentials.json` 파일 다운로드

## 초기 설정

### 1. credentials.json 파일 배치

다운로드한 `credentials.json` 파일을 프로젝트 루트 디렉토리에 배치:

```bash
# 프로젝트 루트 디렉토리 구조
drive-uploader/
├── credentials.json          # ← 여기에 배치
├── cmd/
├── internal/
├── docs/
├── go.mod
└── go.sum
```

### 2. 환경 변수 설정 (선택사항)

`.env` 파일을 생성하여 환경 변수 설정:

```bash
# .env 파일 생성
cat > .env << EOF
TOKEN_FILE_PATH=token.json
EOF
```

### 3. 권한 설정

보안을 위해 credentials.json 파일 권한 설정:

```bash
# macOS/Linux
chmod 600 credentials.json

# Windows (PowerShell)
icacls credentials.json /inheritance:r /grant:r "$($env:USERNAME):(R)"
```

## 첫 실행 및 인증

### 1. 초기 실행 테스트

```bash
# 테스트 파일 생성
echo "Hello, Drive Uploader!" > test.txt

# 프로그램 실행
go run ./cmd/drive-uploader -file test.txt
```

### 2. OAuth 인증 절차

최초 실행 시 다음과 같은 인증 절차가 진행됩니다:

1. **인증 URL 표시**:
   ```
   Go to the following link in your browser and authorize the app:
   https://accounts.google.com/o/oauth2/auth?access_type=offline&client_id=...
   ```

2. **브라우저에서 인증**:
   - 표시된 URL을 브라우저에서 열기
   - Google 계정 로그인
   - 권한 요청 승인

3. **인증 코드 입력**:
   ```
   Enter the authorization code: [브라우저에서 얻은 코드 입력]
   ```

4. **토큰 저장**:
   - 인증 성공 시 `token.json` 파일이 자동 생성
   - 이후 실행 시 저장된 토큰을 재사용

## 문제 해결

### 1. "credentials.json 파일을 찾을 수 없습니다" 오류

**원인**: `credentials.json` 파일이 올바른 위치에 없음

**해결책**:
```bash
# 파일이 프로젝트 루트에 있는지 확인
ls -la credentials.json

# 없다면 Google Cloud Console에서 다시 다운로드
```

### 2. "토큰 파일을 찾을 수 없습니다" 오류

**원인**: 최초 인증이 필요함

**해결책**: 프로그램을 다시 실행하여 인증 절차 진행

### 3. "잘못된 클라이언트 시크릿" 오류

**원인**: `credentials.json` 파일이 손상되었거나 잘못됨

**해결책**:
```bash
# 기존 파일 삭제
rm credentials.json token.json

# Google Cloud Console에서 새로운 자격 증명 다운로드
```

### 4. 방화벽 문제

**원인**: 회사나 학교 네트워크에서 OAuth 접근 차단

**해결책**:
- 개인 네트워크에서 시도
- IT 부서에 Google OAuth 접근 요청

## 다음 단계

설치가 완료되었다면 [사용법 가이드](04_사용법.md)를 참고하여 실제 파일 업로드를 시작해보세요.
